#   ![Assovio](https://img.icons8.com/ios-filled/50/AAAAAA/whispering.png)      Assovio ‚Äì Transcri√ß√£o de √Åudio  HTTP Request 
## Transcri√ß√£o de √Åudio em Portugu√™s Brasileiro via HTTP (Oaut-opt)



[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)        [![GitHub Repository](https://img.shields.io/badge/github%20-%20Repository-%23D8B00??style=for-the-badge&logo=github&logoColor=white)](https://github.com/srvictorbatista/assovio)

**Made Withe:**

 ![Python Slin](https://img.shields.io/badge/python%20-%203%20Slin-%23F1BF7A??style=for-the-badge&logo=python&logoColor=white)        ![Docker-Compose](https://img.shields.io/badge/docker%20-%20Compose%20-%233776AB??style=for-the-badge&logo=docker&logoColor=white)      ![ApiKey](https://img.shields.io/badge/ApiKey%20-%20WEB%20Security%20-%23FC6D26??style=for-the-badge&logo=caddy&logoColor=white)       ![Json](https://img.shields.io/badge/json%20-%20Web%20Response%20-%231B1C30??style=for-the-badge&logo=json&logoColor=white)       ![RAW](https://img.shields.io/badge/RAW%20-%20IA%20Models%20-%237033FD??style=for-the-badge&logo=ray&logoColor=white)  ![FFMPEG](https://img.shields.io/badge/FFMPEG%20-%20Converter%20-%23007808??style=for-the-badge&logo=ffmpeg&logoColor=white)        

**RESTs exemples** (Oaut-opts):

![Python Slin](https://img.shields.io/badge/cURL%20-%20BASH-%23EEEEEE??style=for-the-badge&logo=curl&logoColor=white)         ![Insomnia](https://img.shields.io/badge/Insomnia-%23AD29B6??style=for-the-badge&logo=insomnia&logoColor=white)       ![Postman](https://img.shields.io/badge/Postman-%23FC6D26??style=for-the-badge&logo=postman&logoColor=white)              
![PHP All Versions](https://img.shields.io/badge/PHP%20-%20All%20Versions-%23777BB4??style=for-the-badge&logo=php&logoColor=white)               ![JS All Versions](https://img.shields.io/badge/javascript%20-%20All%20Versions-%23F7DF1E??style=for-the-badge&logo=javascript&logoColor=white)                          ![Python All Versions](https://img.shields.io/badge/python%20-%20All%20Versions-%23F1BF7A??style=for-the-badge&logo=python&logoColor=white)         ![Node.JS All Versions](https://img.shields.io/badge/node.Js%20-%20All%20Versions-%235FA04E??style=for-the-badge&logo=nodedotjs&logoColor=white)


## √çndice

- [Descri√ß√£o](#descri√ß√£o)
- [Caracter√≠sticas T√©cnicas](#caracter√≠sticas-t√©cnicas)
- [Inicio R√°pido!](#inicio-r√°pido)
- [Exemplos de Uso](#exemplos-de-uso)
- [Vari√°veis de Ambiente](#vari√°veis-de-ambiente)
- [Vantagens](#vantagens)
- [Ambiente Docker Compose](#ambiente-docker-compose)
- [Como Executar](#como-executar)
- [Casos de Uso](#casos-de-uso)
- [Seguran√ßa](#seguran√ßa)
- [Limpeza de Arquivos Tempor√°rios](#limpeza-de-arquivos-tempor√°rios)
- [Considera√ß√µes Finais](#considera√ß√µes-finais)
- [Nota T√©cnica](#nota-t√©cnica-expandir)
- [Licen√ßa](#licen√ßa)
- [Destaques e Aplica√ß√µes](#destaques-e-aplica√ß√µes)

---

## Descri√ß√£o

**Assovio** √© um microservi√ßo RESTful em Python para transcri√ß√£o autom√°tica de arquivos de √°udio em portugu√™s brasileiro. Utiliza o reconhecimento de voz **Vosk** com modelos offline para garantir privacidade e independ√™ncia da internet. Pode aplicar corre√ß√£o textual com base em frequ√™ncia via **SymSpell**, aumentando a qualidade do texto final.

Oferece uma rota √∫nica HTTP (`/escutar`) que aceita arquivos via `multipart/form-data` e retorna a transcri√ß√£o em JSON.

---

## Caracter√≠sticas T√©cnicas

- Reconhecimento offline com modelos locais **Vosk**.
- Suporte a m√∫ltiplos formatos, transcodificando automaticamente para `.wav` com **FFmpeg**.
- Corre√ß√£o textual opcional usando **SymSpellPy** e dicion√°rio de alta qualidade.
- Processamento concorrente com `ThreadPoolExecutor`.
- Valida√ß√£o do tamanho m√°ximo do arquivo, configur√°vel via vari√°veis de ambiente.
- Autentica√ß√£o via chave de API para controle de acesso.
- Documenta√ß√£o e exemplos para diversos ambientes (curl, PHP, Python, Node.js).
- Respostas consistentes no formato `application/json`.

---

## Inicio R√°pido!

**Rodando com Docker Compose:**

```bash
docker-compose up --build
```

----------

## Exemplos de Uso


### Usando `cURL` (com autentica√ß√£o)

```bash
curl -X POST -H "apikey: XXXXXXXXXX" -F "audio=@seuarquivo.wav" http://localhost:55507/escutar

```

### Usando `cURL` (sem autentica√ß√£o)

```bash
curl -X POST -F "audio=@seuarquivo.wav" http://localhost:55507/escutar

```

<p> &nbsp</p>
Claro! Que n√£o poderia faltar exemplos de uso simples que fazem a requisi√ß√£o para o endpoint `/escutar` do Assovio, incluindo o envio do arquivo de √°udio e o cabe√ßalho de autentica√ß√£o `apikey`:

----------

### Exemplo em PHP (usando cURL)

```php
<?php

$apikey = "XXXXXXXXXX";
$audioFile = "seuarquivo.wav";
$url = "http://localhost:55507/escutar";

$curl = curl_init();

curl_setopt_array($curl, [
    CURLOPT_URL => $url,
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_HTTPHEADER => [
        "apikey: $apikey",
    ],
    CURLOPT_POSTFIELDS => [
        'audio' => new CURLFile($audioFile)
    ],
]);

$response = curl_exec($curl);

if (curl_errno($curl)) {
    echo 'Erro: ' . curl_error($curl);
} else {
    $decoded = json_decode($response, true);
    print_r($decoded);
}

curl_close($curl);

```

----------

### Exemplo em JavaScript

```javascript
const url = "http://localhost:55507/escutar";
const apikey = "XXXXXXXXXX";

// Seleciona o arquivo de um input do tipo file (exemplo)
const inputFile = document.querySelector('input[type="file"]');

inputFile.addEventListener('change', () => {
  const file = inputFile.files[0];
  if (!file) {
    console.error('Nenhum arquivo selecionado.');
    return;
  }

  const formData = new FormData();
  formData.append('audio', file);

  fetch(url, {
    method: 'POST',
    headers: {
      'apikey': apikey
      // Note que n√£o definimos Content-Type aqui, o fetch faz automaticamente para FormData
    },
    body: formData
  })
  .then(response => {
    if (!response.ok) throw new Error('Erro na requisi√ß√£o: ' + response.status);
    return response.json();
  })
  .then(data => {
    console.log('Transcri√ß√£o:', data);
  })
  .catch(err => {
    console.error(err);
  });
});
```


### Exemplo em Python

```python
import requests

url = "http://localhost:55507/escutar"
headers = {"apikey": "XXXXXXXXXX"}
files = {"audio": open("seuarquivo.wav", "rb")}

response = requests.post(url, headers=headers, files=files)
print(response.json())

```

### Exemplo em Node.js com axios e form-data

```javascript
const axios = require('axios');
const FormData = require('form-data');
const fs = require('fs');

const form = new FormData();
form.append('audio', fs.createReadStream('seuarquivo.wav'));

axios.post('http://localhost:55507/escutar', form, {
  headers: {
    ...form.getHeaders(),
    'apikey': 'XXXXXXXXXX'
  }
}).then(res => {
  console.log(res.data);
}).catch(console.error);

```



## Vari√°veis de Ambiente

| Vari√°vel                 | Tipo    | Padr√£o                                   | Descri√ß√£o                                                                                                                                         |
|--------------------------|---------|------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| `INTERNAL_PORT`          | inteiro  | `55507`                                  | Porta onde o servi√ßo ficar√° dispon√≠vel.                                                                                                           |
| `MODEL_NAME`             | string  | `vosk-model-pt-fb-v0.1.1-20220516_2113`  | Nome do modelo Vosk na pasta `modelos/`. Use o modelo menor (`vosk-model-small-pt-0.3`) para mais velocidade e menor precis√£o, ou o maior para mais assertividade e maior lat√™ncia. |
| `AUTHENTICATION_API_KEY`| string  | `XXXXXXXXXX`                             | Chave de API para autentica√ß√£o do endpoint. Se vazio (`""`), a autentica√ß√£o √© desabilitada.                                                      |
| `INTERNAL_LIMIT`         | inteiro | `10`                                     | Limite m√°ximo para envio de arquivos de √°udio (em MB).                                                                                           |
| `DICIONARIO_DE_FREQUENCIA`| string | `NAO`                                    | Ativa (`SIM`, `1`, `S`, `sim`) ou desativa (`NAO`, `0`, `N`, `nao`) a corre√ß√£o via dicion√°rio SymSpell. Aumenta a acur√°cia o que pode aumentar o consumo de processamento. |
| `WORKERS`                | inteiro | `1`                                      | N√∫mero de processadores f√≠sicos dedicados ao processamento.                                                                                       |
| `THREADS`                | inteiro | `4`                                      | N√∫mero de n√∫cleos virtuais (threads) utilizados. Influencia o uso de cache e mem√≥ria.                                                            |




## Vantagens

-   Reconhecimento 100% offline, garantindo privacidade total.
    
-   Corre√ß√£o textual com dicion√°rio de frequ√™ncia de alta qualidade.
    
-   Arquitetura escal√°vel para uso pessoal e corporativo.
    
-   Suporte a m√∫ltiplos formatos com transcodifica√ß√£o via FFmpeg.
    
-   Baixa lat√™ncia e alta efici√™ncia.

- Alta disponibilidade com baixo consumo.
    
-   Autentica√ß√£o integrada e valida√ß√µes robustas.
    
-   Limpeza autom√°tica de arquivos tempor√°rios.
    

----------

## Ambiente Docker Compose

Estrutura de pastas do reposit√≥rio:

```
assovio/
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ audio.ogg               # √Åudio para demonstra√ß√£o
‚îú‚îÄ‚îÄ audio.mp3               # √Åudio para demonstra√ß√£o
‚îú‚îÄ‚îÄ Dockerfiles/
‚îÇ   ‚îú‚îÄ‚îÄ assovio             # Dockerfile principal
‚îÇ   ‚îú‚îÄ‚îÄ assovio.py          # Script Python dentro do container
‚îÇ   ‚îú‚îÄ‚îÄ assovio.sh          # Script de inicializa√ß√£o
‚îÇ   ‚îî‚îÄ‚îÄ assovio_dicionario_de_frequancia.py  # Script para buildar o dicion√°rio interno

```

----------

## Como Executar

1.  Com **docker** e **docker-compose** instalado em seu ambiente. Execute: 
`docker-compose up --build -d` 
    
2.  Pronto! Agora √© s√≥ desfrutar do servi√ßo.

3. Uma das formas mais simples de usar este servi√ßo, assim que erguido. √â enviando uma requisi√ß√£o cURL:
```bash
curl -X POST -H "apikey: XXXXXXXXXX" -F "audio=@seuarquivo.wav" http://localhost:55507/escutar
```

Sendo **``seuarquivo.wav``**  o arquivo de √°udio que voc√™ deseja transcrever e **``XXXXXXXXXX``** a chave-api definida no arquivo **``docker-compose.yml``**.



----------

## Casos de Uso

-   Sistemas de atendimento automatizado (URA).
    
-   Transcri√ß√£o de entrevistas, reuni√µes, podcasts e v√≠deos.
    
-   Comandos de voz para automa√ß√£o industrial e residencial.
    
-   Processamento para an√°lises jur√≠dicas e acad√™micas.
    
-   Ferramentas de acessibilidade para deficientes auditivos.
    

----------

## Seguran√ßa

Se configurada, a vari√°vel `AUTHENTICATION_API_KEY` requer que as requisi√ß√µes incluam o cabe√ßalho:

```
apikey: XXXXXXXXXX
```
Protegendo o servi√ßo contra acessos n√£o autorizados.
√â altamente recomendado que voc√™ **substitua a serie de "XXXXXXXXXX" por sua apikey √∫nica**. 
<br>
 Uma forma **simples e pratica** de gerar sua pr√≥pria apikey √∫nica. √â executando o seguinte comando **a partir de um terminal BASH** (o que inclui o pr√≥prio container, se preferir):
 
**``` clear && printf "\n\nSua apikey: \033[1;37;44m %s \033[0m\n\n\n\n" "$(tr -dc 'A-Z0-9' </dev/urandom | head -c10)"```**
Onde "-c" corresponde ao total de caracteres desejados. Neste exemplo, 10.

_Os √°udios recebidos, s√£o **imediatamente exclu√≠dos** do servidor, assim que transcritos. **N√£o restando dados remanescentes** da opera√ß√£o._ 

Al√©m disto. O servi√ßo √© fornecido em um **ambiente docker**, o que j√° garante seu **isolamento por padr√£o**. E ao mesmo tempo, a **conectividade necess√°ria para desfrutar** do servi√ßo com seguran√ßa e controles de acesso isoladamente.

----------

## Limpeza de Arquivos Tempor√°rios

Arquivos gerados durante o processamento s√£o removidos automaticamente ap√≥s cada requisi√ß√£o, garantindo seguran√ßa e economia de espa√ßo.

----------

## Considera√ß√µes Finais

Assovio √© uma solu√ß√£o robusta e eficiente para transcri√ß√£o de √°udio em portugu√™s, com foco em privacidade, desempenho e escalabilidade. Seu design modular facilita adapta√ß√µes para diversos ambientes, do pessoal ao corporativo.

O **dicion√°rio interno** √© buildado a partir de um √≠ndice amostral de 200 mil palavras classificadas e indexadas por [**WordFrequency**](https://www.wordfrequency.info/portuguese.asp) com base na frequancia de ocorrencia na lingua portufuesa, no per√≠odo de 2012 a 2019. Obtido em https://www.wordfrequency.info/portuguese.asp neste projeto inclui um script de automa√ß√£o que baixa esta amotra e constroi um dicion√°rio interno com base nesta amostra. Segundo a fonte, os dados s√£o baseados em palavras obtidas e analisadas do [**corpus Web/Dialects**](https://www.corpusdoportugues.org/web-dial/) do Corpus do Portugu√™s.
Para quem gosta deste tipo de pesquisa/analise estat√≠stica, vale am pena dar uma olhada em [**jusText**](https://pypi.org/project/jusText). Trata-se da ferramenta em python usada pela **Web/Dialects** para limpeza durante a cataloga√ß√£o dos dados (webScrap) e voc√™ pode [ver mais sobre ela aqui](https://code.google.com/archive/p/justext). Como dados tecncos e uma [amostra](https://nlp.fi.muni.cz/projects/justext) de uso online. Sendo uma poderosa e √∫til ferramenta para cria√ß√£o de recursos lingu√≠sticos.







## [Nota T√©cnica (expandir)](#nota-tecnica-expandir)
<details>

###  &nbsp; <a href="#nota-tecnica-expandir" target="_blank">Aspectos Importantes</a>
 &nbsp; &nbsp; <summary id="several-resume"><em>Este projeto foi testado e revisado por pares, antes da sua primeira publica√ß√£o.</em></summary>


<br>

### DICION√ÅRIOS LINGU√çSTICOS

O uso de **dicion√°rios lingu√≠sticos** para suporte a modelos longos em **motores autohospedados** tem se revelado uma estrat√©gia altamente eficaz para ampliar a **assertividade anal√≠tica em tempo real**. Entretanto, essa abordagem incorre em **custos computacionais e impactos diretos no tempo de resposta**, aspectos que precisam ser criteriosamente avaliados de acordo com as condi√ß√µes de infraestrutura, o n√≠vel de exposi√ß√£o e os objetivos do ambiente em quest√£o.

### DIMENSIONAMENTO E ALOCA√á√ÉO DE RECURSOS

Em cen√°rios com infraestrutura limitada, em universos amostrais reduzidos ou em contextos em que **a agilidade operacional seja mais importante que a precis√£o lingu√≠stica**, **n√£o recomendo a ado√ß√£o de dicion√°rios de frequ√™ncia lingu√≠stica**, tampouco de modelos extensos. Em diversos testes realizados, a inclus√£o desses componentes **n√£o apresentou ganhos significativos na qualidade dos resultados**. Pelo contr√°rio ‚Äî observou-se, em alguns casos, **um aumento no tempo de resposta** e **degrada√ß√£o da qualidade l√©xica e sint√°tica**, quando comparado ao uso corretamente dimensionado desses mesmos recursos.

Como exemplo pr√°tico de **dimensionamento eficiente**, menciono requisi√ß√µes contendo √°udios superiores a 3 minutos que foram processadas com extremo sucesso em **fra√ß√µes de segundo**, utilizando apenas um n√∫cleo f√≠sico (3.0 GHz) e 4 threads (configura√ß√£o padr√£o). Importante destacar que tais resultados foram obtidos **sem o uso de dicion√°rios lingu√≠sticos**, operando com um **modelo longo de 14 bilh√µes de par√¢metros**, previamente ajustado para **execu√ß√£o simult√¢nea em ambientes de produ√ß√£o com m√∫ltiplas requisi√ß√µes concorrentes**.

Diante disso, **recomendo fortemente a realiza√ß√£o de testes controlados e ajustes finos nos par√¢metros**, considerando as caracter√≠sticas espec√≠ficas de cada aplica√ß√£o. Estou convicto de que **os resultados obtidos ‚Äî mesmo com infraestrutura modesta ‚Äî podem ser compar√°veis (ou superiores)** aos oferecidos por solu√ß√µes comerciais de grande porte e alto custo.

Adicionalmente, destaco que **a crescente vilaniza√ß√£o de servi√ßos externos** (como clouds e plataformas SaaS) ‚Äî muitas vezes criticados por seus custos elevados, tr√°fego excessivo ou uso intensivo de processamento ‚Äî tem motivado a busca por **alternativas aut√¥nomas, mais eficientes e economicamente vi√°veis**. Esta proposta foi concebida justamente com esse prop√≥sito: **oferecer performance de alto n√≠vel, com independ√™ncia operacional e controle total sobre os recursos disponibilizados**.

</details>


----------



&nbsp;



## [Licen√ßa](#licenca)
<details>
 &nbsp; <summary id="licenca">Este projeto est√° licenciado sob a Licen√ßa MIT</summary>

## &nbsp; &nbsp; <a href="https://opensource.org/licenses/MIT" target="_blank">Licen√ßa MIT - Open Source</a>

√â concedida permiss√£o, gratuitamente, a qualquer pessoa que obtenha uma c√≥pia deste software e dos arquivos de documenta√ß√£o associados (o ‚ÄúSoftware‚Äù), para negociar o Software sem restri√ß√µes, incluindo, sem limita√ß√£o, os direitos de usar, copiar, modificar, mesclar , publicar, distribuir, sublicenciar e/ou vender c√≥pias do Software e permitir que as pessoas a quem o Software seja fornecido o fa√ßam, sujeito √†s seguintes condi√ß√µes:

O aviso de direitos autorais acima e este aviso de permiss√£o ser√£o inclu√≠dos em todas as c√≥pias ou partes substanciais do Software.

<STRONG> O SOFTWARE √â FORNECIDO ‚ÄúNO ESTADO EM QUE SE ENCONTRA‚Äù, SEM GARANTIA DE QUALQUER TIPO, EXPRESSA OU IMPL√çCITA, INCLUINDO, MAS N√ÉO SE LIMITANDO √ÄS GARANTIAS DE COMERCIALIZA√á√ÉO, ADEQUA√á√ÉO A UM DETERMINADO FIM E N√ÉO VIOLA√á√ÉO. EM HIP√ìTESE ALGUMA OS AUTORES OU DETENTORES DE DIREITOS AUTORAIS SER√ÉO RESPONS√ÅVEIS POR QUALQUER RECLAMA√á√ÉO, DANOS OU OUTRA RESPONSABILIDADE, SEJA EM UMA A√á√ÉO DE CONTRATO, ATO IL√çCITO OU DE OUTRA FORMA, DECORRENTE DE, OU EM CONEX√ÉO COM O SOFTWARE OU O USO OU OUTRAS NEGOCIA√á√ïES NO PROGRAMA.</STRONG>


A Licen√ßa MIT √© uma licen√ßa de software de c√≥digo aberto que permite aos usu√°rios utilizar, modificar, distribuir e sublicenciar o software sem restri√ß√µes significativas, desde que a notifica√ß√£o de direitos autorais e a licen√ßa sejam inclu√≠das em todas as c√≥pias ou partes substanciais do software.

A Licen√ßa MIT √© conhecida por sua simplicidade e permissividade. Ela permite que os usu√°rios fa√ßam praticamente qualquer coisa com o software, incluindo o uso comercial, sem a necessidade de compartilhar as modifica√ß√µes ou melhorias que fa√ßam no c√≥digo-fonte.

Principais caracter√≠sticas da Licen√ßa MIT:
- **Permissiva**: A Licen√ßa MIT √© considerada uma das licen√ßas mais permissivas em termos de uso de software. Ela permite que os usu√°rios fa√ßam quase tudo o que quiserem com o software, incluindo o uso comercial, sem muitas restri√ß√µes.
- **Requisitos m√≠nimos**: A licen√ßa √© muito curta e simples, com requisitos m√≠nimos para o uso e redistribui√ß√£o do software. Geralmente, exige apenas a inclus√£o do aviso de direitos autorais e da licen√ßa em todas as c√≥pias do software.
- **Compatibilidade**: A Licen√ßa MIT √© compat√≠vel com muitas outras licen√ßas de c√≥digo aberto, permitindo que o software licenciado sob a MIT seja combinado e distribu√≠do com software licenciado sob outras licen√ßas de c√≥digo aberto.

A Licen√ßa MIT √© uma escolha popular para projetos de software de c√≥digo aberto devido √† sua simplicidade e permissividade, permitindo que os desenvolvedores compartilhem e usem software com poucas restri√ß√µes.

</details>


<BR><BR>


### Autor: Sr. Victor Batista -  t.me/LevyMac 
| [<img src="https://avatars.githubusercontent.com/u/131806887?v=4" width=85><br><sup>Sr. Victor Batista</sup>](https://github.com/srvictorbatista) |
| :---: |

##### CONTATO: 
[![Contact|Solid](https://img.shields.io/badge/contact%20%5BPT--BR%5D-@levymac-9cf?labelColor=brightgrey&style=for-the-badge&logo=telegram)](https://t.me/levymac)




----------

## Destaques e Aplica√ß√µes

-   Domino e privacidade total (100% offline).
    
-   Baixo custo operacional sem depend√™ncia de servi√ßos pagos na nuvem.
    
-   Integra√ß√£o simples e instant√¢nea, via API REST.
    
-   Alta performance em hardware modesto. 

-   Alta portabilidade com baixa lat√™ncia (self-hosted).

-   Extremamente escal√°vel, em ambientes de produ√ß√£o.
    
-   Aplica√ß√µes educacionais, jur√≠dicas, industriais, e mais.
    
-   F√°cil customiza√ß√£o para novos idiomas, modelos e usos.
    

    
----------

# Obrigado por assoviar tamb√©m! üòôüöÄ



